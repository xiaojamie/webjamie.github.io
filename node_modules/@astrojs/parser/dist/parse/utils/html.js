var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __markAsModule = (target) => __defProp(target, "__esModule", { value: true });
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __reExport = (target, module2, copyDefault, desc) => {
  if (module2 && typeof module2 === "object" || typeof module2 === "function") {
    for (let key of __getOwnPropNames(module2))
      if (!__hasOwnProp.call(target, key) && (copyDefault || key !== "default"))
        __defProp(target, key, { get: () => module2[key], enumerable: !(desc = __getOwnPropDesc(module2, key)) || desc.enumerable });
  }
  return target;
};
var __toESM = (module2, isNodeMode) => {
  return __reExport(__markAsModule(__defProp(module2 != null ? __create(__getProtoOf(module2)) : {}, "default", !isNodeMode && module2 && module2.__esModule ? { get: () => module2.default, enumerable: true } : { value: module2, enumerable: true })), module2);
};
var __toCommonJS = /* @__PURE__ */ ((cache) => {
  return (module2, temp) => {
    return cache && cache.get(module2) || (temp = __reExport(__markAsModule({}), module2, 1), cache && cache.set(module2, temp), temp);
  };
})(typeof WeakMap !== "undefined" ? /* @__PURE__ */ new WeakMap() : 0);
var html_exports = {};
__export(html_exports, {
  closing_tag_omitted: () => closing_tag_omitted,
  decode_character_references: () => decode_character_references
});
var import_entities = __toESM(require("./entities.js"));
const windows_1252 = [
  8364,
  129,
  8218,
  402,
  8222,
  8230,
  8224,
  8225,
  710,
  8240,
  352,
  8249,
  338,
  141,
  381,
  143,
  144,
  8216,
  8217,
  8220,
  8221,
  8226,
  8211,
  8212,
  732,
  8482,
  353,
  8250,
  339,
  157,
  382,
  376
];
const entity_pattern = new RegExp(`&(#?(?:x[\\w\\d]+|\\d+|${Object.keys(import_entities.default).join("|")}))(?:;|\\b)`, "g");
function decode_character_references(html) {
  return html.replace(entity_pattern, (match, entity) => {
    let code;
    if (entity[0] !== "#") {
      code = import_entities.default[entity];
    } else if (entity[1] === "x") {
      code = parseInt(entity.substring(2), 16);
    } else {
      code = parseInt(entity.substring(1), 10);
    }
    if (!code) {
      return match;
    }
    return String.fromCodePoint(validate_code(code));
  });
}
const NUL = 0;
function validate_code(code) {
  if (code === 10) {
    return 32;
  }
  if (code < 128) {
    return code;
  }
  if (code <= 159) {
    return windows_1252[code - 128];
  }
  if (code < 55296) {
    return code;
  }
  if (code <= 57343) {
    return NUL;
  }
  if (code <= 65535) {
    return code;
  }
  if (code >= 65536 && code <= 131071) {
    return code;
  }
  if (code >= 131072 && code <= 196607) {
    return code;
  }
  return NUL;
}
const disallowed_contents = /* @__PURE__ */ new Map([
  ["li", /* @__PURE__ */ new Set(["li"])],
  ["dt", /* @__PURE__ */ new Set(["dt", "dd"])],
  ["dd", /* @__PURE__ */ new Set(["dt", "dd"])],
  ["p", new Set("address article aside blockquote div dl fieldset footer form h1 h2 h3 h4 h5 h6 header hgroup hr main menu nav ol p pre section table ul".split(" "))],
  ["rt", /* @__PURE__ */ new Set(["rt", "rp"])],
  ["rp", /* @__PURE__ */ new Set(["rt", "rp"])],
  ["optgroup", /* @__PURE__ */ new Set(["optgroup"])],
  ["option", /* @__PURE__ */ new Set(["option", "optgroup"])],
  ["thead", /* @__PURE__ */ new Set(["tbody", "tfoot"])],
  ["tbody", /* @__PURE__ */ new Set(["tbody", "tfoot"])],
  ["tfoot", /* @__PURE__ */ new Set(["tbody"])],
  ["tr", /* @__PURE__ */ new Set(["tr", "tbody"])],
  ["td", /* @__PURE__ */ new Set(["td", "th", "tr"])],
  ["th", /* @__PURE__ */ new Set(["td", "th", "tr"])]
]);
function closing_tag_omitted(current, next) {
  if (disallowed_contents.has(current)) {
    if (!next || disallowed_contents.get(current).has(next)) {
      return true;
    }
  }
  return false;
}
module.exports = __toCommonJS(html_exports);
// Annotate the CommonJS export names for ESM import in node:
0 && (module.exports = {
  closing_tag_omitted,
  decode_character_references
});
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vc3JjL3BhcnNlL3V0aWxzL2h0bWwudHMiXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUEsc0JBQXFCO0FBRXJCLE1BQU0sZUFBZTtBQUFBLEVBQ3BCO0FBQUEsRUFBTTtBQUFBLEVBQUs7QUFBQSxFQUFNO0FBQUEsRUFBSztBQUFBLEVBQU07QUFBQSxFQUFNO0FBQUEsRUFBTTtBQUFBLEVBQU07QUFBQSxFQUFLO0FBQUEsRUFBTTtBQUFBLEVBQUs7QUFBQSxFQUFNO0FBQUEsRUFBSztBQUFBLEVBQUs7QUFBQSxFQUFLO0FBQUEsRUFBSztBQUFBLEVBQUs7QUFBQSxFQUFNO0FBQUEsRUFBTTtBQUFBLEVBQU07QUFBQSxFQUFNO0FBQUEsRUFBTTtBQUFBLEVBQU07QUFBQSxFQUFNO0FBQUEsRUFBSztBQUFBLEVBQU07QUFBQSxFQUFLO0FBQUEsRUFBTTtBQUFBLEVBQUs7QUFBQSxFQUFLO0FBQUEsRUFBSztBQUM3SztBQUVBLE1BQU0saUJBQWlCLElBQUksT0FBTywwQkFBMEIsT0FBTyxLQUFLLHVCQUFRLEVBQUUsS0FBSyxHQUFHLGdCQUFnQixHQUFHO0FBRXRHLHFDQUFxQyxNQUFjO0FBQ3pELFNBQU8sS0FBSyxRQUFRLGdCQUFnQixDQUFDLE9BQU8sV0FBVztBQUN0RCxRQUFJO0FBR0osUUFBSSxPQUFPLE9BQU8sS0FBSztBQUN0QixhQUFPLHdCQUFTO0FBQUEsSUFDakIsV0FBVyxPQUFPLE9BQU8sS0FBSztBQUM3QixhQUFPLFNBQVMsT0FBTyxVQUFVLENBQUMsR0FBRyxFQUFFO0FBQUEsSUFDeEMsT0FBTztBQUNOLGFBQU8sU0FBUyxPQUFPLFVBQVUsQ0FBQyxHQUFHLEVBQUU7QUFBQSxJQUN4QztBQUVBLFFBQUksQ0FBQyxNQUFNO0FBQ1YsYUFBTztBQUFBLElBQ1I7QUFFQSxXQUFPLE9BQU8sY0FBYyxjQUFjLElBQUksQ0FBQztBQUFBLEVBQ2hELENBQUM7QUFDRjtBQUVBLE1BQU0sTUFBTTtBQU9aLHVCQUF1QixNQUFjO0FBRXBDLE1BQUksU0FBUyxJQUFJO0FBQ2hCLFdBQU87QUFBQSxFQUNSO0FBR0EsTUFBSSxPQUFPLEtBQUs7QUFDZixXQUFPO0FBQUEsRUFDUjtBQUlBLE1BQUksUUFBUSxLQUFLO0FBQ2hCLFdBQU8sYUFBYSxPQUFPO0FBQUEsRUFDNUI7QUFHQSxNQUFJLE9BQU8sT0FBTztBQUNqQixXQUFPO0FBQUEsRUFDUjtBQUdBLE1BQUksUUFBUSxPQUFPO0FBQ2xCLFdBQU87QUFBQSxFQUNSO0FBR0EsTUFBSSxRQUFRLE9BQU87QUFDbEIsV0FBTztBQUFBLEVBQ1I7QUFHQSxNQUFJLFFBQVEsU0FBUyxRQUFRLFFBQVE7QUFDcEMsV0FBTztBQUFBLEVBQ1I7QUFHQSxNQUFJLFFBQVEsVUFBVSxRQUFRLFFBQVE7QUFDckMsV0FBTztBQUFBLEVBQ1I7QUFFQSxTQUFPO0FBQ1I7QUFHQSxNQUFNLHNCQUFzQixvQkFBSSxJQUFJO0FBQUEsRUFDbkMsQ0FBQyxNQUFNLG9CQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUFBLEVBQ3RCLENBQUMsTUFBTSxvQkFBSSxJQUFJLENBQUMsTUFBTSxJQUFJLENBQUMsQ0FBQztBQUFBLEVBQzVCLENBQUMsTUFBTSxvQkFBSSxJQUFJLENBQUMsTUFBTSxJQUFJLENBQUMsQ0FBQztBQUFBLEVBQzVCLENBQUMsS0FBSyxJQUFJLElBQUksMElBQTBJLE1BQU0sR0FBRyxDQUFDLENBQUM7QUFBQSxFQUNuSyxDQUFDLE1BQU0sb0JBQUksSUFBSSxDQUFDLE1BQU0sSUFBSSxDQUFDLENBQUM7QUFBQSxFQUM1QixDQUFDLE1BQU0sb0JBQUksSUFBSSxDQUFDLE1BQU0sSUFBSSxDQUFDLENBQUM7QUFBQSxFQUM1QixDQUFDLFlBQVksb0JBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO0FBQUEsRUFDbEMsQ0FBQyxVQUFVLG9CQUFJLElBQUksQ0FBQyxVQUFVLFVBQVUsQ0FBQyxDQUFDO0FBQUEsRUFDMUMsQ0FBQyxTQUFTLG9CQUFJLElBQUksQ0FBQyxTQUFTLE9BQU8sQ0FBQyxDQUFDO0FBQUEsRUFDckMsQ0FBQyxTQUFTLG9CQUFJLElBQUksQ0FBQyxTQUFTLE9BQU8sQ0FBQyxDQUFDO0FBQUEsRUFDckMsQ0FBQyxTQUFTLG9CQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUFBLEVBQzVCLENBQUMsTUFBTSxvQkFBSSxJQUFJLENBQUMsTUFBTSxPQUFPLENBQUMsQ0FBQztBQUFBLEVBQy9CLENBQUMsTUFBTSxvQkFBSSxJQUFJLENBQUMsTUFBTSxNQUFNLElBQUksQ0FBQyxDQUFDO0FBQUEsRUFDbEMsQ0FBQyxNQUFNLG9CQUFJLElBQUksQ0FBQyxNQUFNLE1BQU0sSUFBSSxDQUFDLENBQUM7QUFDbkMsQ0FBQztBQUlNLDZCQUE2QixTQUFpQixNQUFlO0FBQ25FLE1BQUksb0JBQW9CLElBQUksT0FBTyxHQUFHO0FBQ3JDLFFBQUksQ0FBQyxRQUFRLG9CQUFvQixJQUFJLE9BQU8sRUFBRSxJQUFJLElBQUksR0FBRztBQUN4RCxhQUFPO0FBQUEsSUFDUjtBQUFBLEVBQ0Q7QUFFQSxTQUFPO0FBQ1I7IiwKICAibmFtZXMiOiBbXQp9Cg==
